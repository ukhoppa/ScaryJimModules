-- Rocks module
local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local RunService = game:GetService("RunService")

local Rocks = {}

-- Local player
local LocalPlayer = Players.LocalPlayer
local char = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()

-- References
local hrp = char:WaitForChild("HumanoidRootPart")

-- Island info
local IslandFolder = nil
local CurrentIslandValue = Instance.new("StringValue")
CurrentIslandValue.Name = "CurrentIsland"
CurrentIslandValue.Value = "Unknown"
CurrentIslandValue.Parent = LocalPlayer

-- Loop control
local loopActive = true -- internal loop for updating island

-- Helper: detect the player's island folder
local function detectIsland()
    local islandsFolder = Workspace:FindFirstChild("Islands")
    if not islandsFolder then
        CurrentIslandValue.Value = "Unknown"
        return nil
    end

    local current = char.Parent
    while current and current ~= islandsFolder and current ~= workspace do
        if current.Parent == islandsFolder then
            IslandFolder = current
            CurrentIslandValue.Value = current.Name
            return IslandFolder
        end
        current = current.Parent
    end

    IslandFolder = nil
    CurrentIslandValue.Value = "Unknown"
    return nil
end

-- Public API to get current island folder
function Rocks.GetIslandFolder()
    return IslandFolder or detectIsland()
end

-- Public API to get current island name
function Rocks.GetIslandName()
    return CurrentIslandValue.Value
end

-- Loop to update island every second
task.spawn(function()
    while loopActive do
        detectIsland()
        task.wait(1)
    end
end)

-- Cleanup
function Rocks.Stop()
    loopActive = false
end

-- Return module
return Rocks
