-- Rocks module skeleton
local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local RunService = game:GetService("RunService")

local LocalPlayer = Players.LocalPlayer
local char = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
local hrp = char:WaitForChild("HumanoidRootPart")

local Rocks = {}

-- StringValue to store current island name for Rayfield
local IslandNameValue = Instance.new("StringValue")
IslandNameValue.Name = "CurrentIsland"
IslandNameValue.Value = "Unknown"
IslandNameValue.Parent = LocalPlayer

-- Function to detect the island folder
local function detectIsland()
    local islandsFolder = Workspace:FindFirstChild("Islands")
    if not islandsFolder then return nil end

    local currentIsland = char and char.Parent
    while currentIsland and currentIsland ~= islandsFolder and currentIsland ~= workspace do
        if currentIsland.Parent == islandsFolder then
            IslandNameValue.Value = currentIsland.Name
            return currentIsland
        end
        currentIsland = currentIsland.Parent
    end

    IslandNameValue.Value = "Unknown"
    return nil
end

-- Public API
function Rocks.GetIsland()
    return detectIsland()
end

function Rocks.GetIslandName()
    return IslandNameValue.Value
end

-- Auto-update island every second
task.spawn(function()
    while true do
        detectIsland()
        task.wait(1)
    end
end)

-- Update references on respawn
LocalPlayer.CharacterAdded:Connect(function(newChar)
    char = newChar
    hrp = newChar:WaitForChild("HumanoidRootPart")
    detectIsland() -- update immediately
end)

return Rocks
